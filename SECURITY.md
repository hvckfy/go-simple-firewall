# üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Go Simple Firewall

–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä –º–æ–¥—É–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–æ–±–∑–æ—Ä-–º–æ–¥—É–ª–µ–π-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [SQL Injection Protection](#sql-injection-protection)
- [XSS Protection](#xss-protection)
- [DDoS Protection](#ddos-protection)
- [Scanner Protection](#scanner-protection)
- [Bot Protection](#bot-protection)
- [Directory Protection](#directory-protection)
- [Suffix Protection](#suffix-protection)
- [Geo-blocking](#geo-blocking)
- [Rate Limiting](#rate-limiting)
- [IP Management](#ip-management)
- [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
- [–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏](#–ª—É—á—à–∏–µ-–ø—Ä–∞–∫—Ç–∏–∫–∏)

## üõ°Ô∏è –û–±–∑–æ—Ä –º–æ–¥—É–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Go Simple Firewall –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É –æ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫:

| –ú–æ–¥—É–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|--------|----------|----------------|--------------|
| SQL Injection | –ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| XSS Protection | –ó–∞—â–∏—Ç–∞ –æ—Ç XSS –∞—Ç–∞–∫ | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| DDoS Protection | –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS –∞—Ç–∞–∫ | –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| Scanner Protection | –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–∫–∞–Ω–µ—Ä–æ–≤ | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| Bot Protection | –ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤ | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| Directory Protection | –ó–∞—â–∏—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| Suffix Protection | –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ | –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω | ‚úÖ –í–∫–ª—é—á–µ–Ω |
| Geo-blocking | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è | ‚ùå –í—ã–∫–ª—é—á–µ–Ω |

## üíâ SQL Injection Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã (GET –∏ POST –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) –Ω–∞ –Ω–∞–ª–∏—á–∏–µ SQL –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è SQL –∏–Ω—ä–µ–∫—Ü–∏–π.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_sql_protection": true,
    "sql_keywords": [
      "union", "select", "insert", "delete", "update",
      "drop", "create", "alter", "exec", "script",
      "declare", "cast", "convert", "having", "where",
      "order", "group", "by", "from", "into", "values",
      "information_schema", "sysobjects", "syscolumns"
    ]
  }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```
GET /search?q=1' UNION SELECT * FROM users--
POST /login with data: username=admin' OR '1'='1
GET /product?id=1; DROP TABLE products;
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "Security Protection"
2. –ù–∞–π–¥–∏—Ç–µ "SQL Injection Protection"
3. –í–∫–ª—é—á–∏—Ç–µ/–≤—ã–∫–ª—é—á–∏—Ç–µ –º–æ–¥—É–ª—å
4. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–æ–∫ SQL –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
5. –ù–∞–∂–º–∏—Ç–µ "Update Security Settings"

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞

**–ë–∞–∑–æ–≤—ã–µ SQL –∫–æ–º–∞–Ω–¥—ã:**
```
union, select, insert, delete, update, drop, create, alter
```

**–§—É–Ω–∫—Ü–∏–∏ –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:**
```
exec, execute, cast, convert, concat, substring, ascii, char
```

**–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**
```
information_schema, sysobjects, syscolumns, pg_tables, sqlite_master
```

**–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç–µ–ª–∏:**
```
--, /*, */, #, ;
```

## üé≠ XSS Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç Cross-Site Scripting –∞—Ç–∞–∫, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ JavaScript –∫–æ–¥–∞ –∏ HTML —Ç–µ–≥–æ–≤.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_xss_protection": true,
    "xss_patterns": [
      "<script", "javascript:", "onload=", "onerror=",
      "onclick=", "onmouseover=", "onfocus=", "onblur=",
      "eval(", "alert(", "confirm(", "prompt(",
      "document.cookie", "window.location", "innerHTML"
    ]
  }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

```
GET /search?q=<script>alert('XSS')</script>
POST /comment with data: text=<img src=x onerror=alert(1)>
GET /redirect?url=javascript:alert(document.cookie)
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ XSS –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**HTML —Å–æ–±—ã—Ç–∏—è:**
```
onload, onerror, onclick, onmouseover, onfocus, onblur, onchange, onsubmit
```

**JavaScript —Ñ—É–Ω–∫—Ü–∏–∏:**
```
eval, setTimeout, setInterval, Function, alert, confirm, prompt
```

**DOM –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏:**
```
document.write, innerHTML, outerHTML, insertAdjacentHTML
```

**–ü—Ä–æ—Ç–æ–∫–æ–ª—ã:**
```
javascript:, data:, vbscript:, livescript:
```

## üåä DDoS Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS –∞—Ç–∞–∫, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—â–∞—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∫–∞–∂–¥–æ–≥–æ IP –∞–¥—Ä–µ—Å–∞ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–∫–Ω–µ.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_ddos_protection": true,
    "ddos_threshold": 100,
    "ddos_time_window": 60,
    "ddos_ban_duration": 30
  }
}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
|----------|----------|------------------------|
| `ddos_threshold` | –ú–∞–∫—Å–∏–º—É–º –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥ | 50-200 |
| `ddos_time_window` | –í—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ (—Å–µ–∫—É–Ω–¥—ã) | 30-120 |
| `ddos_ban_duration` | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–Ω–∞ (–º–∏–Ω—É—Ç—ã) | 15-60 |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

**–î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤:**
```json
{
  "ddos_threshold": 50,
  "ddos_time_window": 60,
  "ddos_ban_duration": 30
}
```

**–î–ª—è API —Å–µ—Ä–≤–∏—Å–æ–≤:**
```json
{
  "ddos_threshold": 200,
  "ddos_time_window": 30,
  "ddos_ban_duration": 15
}
```

**–î–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π:**
```json
{
  "ddos_threshold": 500,
  "ddos_time_window": 60,
  "ddos_ban_duration": 10
}
```

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. Firewall –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∫–∞–∂–¥–æ–≥–æ IP
2. –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–∫–æ–ª—å–∑—è—â–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ–∫–Ω–µ
3. –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ —Å–æ–∑–¥–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±–∞–Ω
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–º–∞–µ—Ç –±–∞–Ω –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏

## üîç Scanner Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∫–∞–Ω–µ—Ä–æ–≤ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π, –±–ª–æ–∫–∏—Ä—É—è –¥–æ—Å—Ç—É–ø –∫ —á–∞—Å—Ç–æ —Å–∫–∞–Ω–∏—Ä—É–µ–º—ã–º –ø—É—Ç—è–º.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_scanner_protection": true,
    "scanner_paths": [
      "/admin", "/wp-admin", "/phpmyadmin", "/cpanel",
      "/webmail", "/.env", "/config", "/backup",
      "/test", "/demo", "/staging", "/dev",
      "/api/v1", "/api/v2", "/rest", "/graphql"
    ]
  }
}
```

### –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—É—Ç–∏ —Å–∫–∞–Ω–µ—Ä–æ–≤

**–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–∞–Ω–µ–ª–∏:**
```
/admin, /administrator, /wp-admin, /cpanel, /plesk, /webmin
```

**–§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```
/.env, /config, /.git, /.svn, /web.config, /.htaccess
```

**–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```
/phpmyadmin, /adminer, /mysql, /postgresql, /mongodb
```

**–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:**
```
/backup, /backups, /dump, /sql, /database
```

**–¢–µ—Å—Ç–æ–≤—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```
/test, /testing, /demo, /staging, /dev, /development
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö CMS

**WordPress:**
```
/wp-admin, /wp-login.php, /wp-config.php, /wp-content/uploads,
/xmlrpc.php, /wp-json, /readme.html, /license.txt
```

**Drupal:**
```
/admin, /user, /node, /sites/default, /modules, /themes,
/install.php, /update.php, /cron.php
```

**Joomla:**
```
/administrator, /installation, /configuration.php, /htaccess.txt,
/web.config.txt, /joomla.xml
```

## ü§ñ Bot Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–§–∏–ª—å—Ç—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –±–æ—Ç–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ User-Agent –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_bot_protection": true,
    "suspicious_user_agents": [
      "bot", "crawler", "spider", "scraper", "scanner",
      "nikto", "sqlmap", "nmap", "masscan", "zap",
      "curl", "wget", "python-requests", "go-http-client"
    ]
  }
}
```

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–æ—Ç–æ–≤

**–°–∫–∞–Ω–µ—Ä—ã —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π:**
```
nikto, nessus, openvas, acunetix, burpsuite, zap, w3af
```

**SQL –∏–Ω—ä–µ–∫—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
```
sqlmap, havij, pangolin, safe3si, bsqlbf
```

**–°–µ—Ç–µ–≤—ã–µ —Å–∫–∞–Ω–µ—Ä—ã:**
```
nmap, masscan, zmap, unicornscan, hping
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
```
curl, wget, python-requests, go-http-client, java, perl
```

**–í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –±–æ—Ç—ã:**
```
semrushbot, ahrefsbot, mj12bot, dotbot, blexbot
```

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –±–æ—Ç–æ–≤

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–∏—Å–∫–æ–≤—ã—Ö), –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ whitelist:

```json
{
  "allowed_user_agents": [
    "Googlebot", "Bingbot", "Slurp", "DuckDuckBot",
    "Baiduspider", "YandexBot", "facebookexternalhit"
  ]
}
```

## üìÅ Directory Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º –∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –≤–µ–±.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_directory_protection": true,
    "protected_directories": [
      "/.git", "/.svn", "/backup", "/config",
      "/logs", "/tmp", "/.env", "/node_modules",
      "/.vscode", "/.idea", "/vendor", "/storage"
    ]
  }
}
```

### –°–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Ä—Å–∏–π

```
/.git, /.svn, /.hg, /.bzr, /CVS, /.gitignore, /.gitmodules
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
/.env, /config, /.config, /settings, /conf, /etc
```

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```
/tmp, /temp, /cache, /logs, /log, /var, /storage
```

### IDE –∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ã

```
/.vscode, /.idea, /.sublime-project, /.atom, /.brackets
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```
/node_modules, /vendor, /bower_components, /packages
```

## üìÑ Suffix Protection

### –û–ø–∏—Å–∞–Ω–∏–µ

–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ —Ñ–∞–π–ª–∞–º —Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ –∏ —Å–æ–∑–¥–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±–∞–Ω—ã –¥–ª—è –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_suffix_protection": true,
    "forbidden_suffixes": [
      ".php", ".asp", ".aspx", ".jsp", ".cgi",
      ".pl", ".py", ".rb", ".sh", ".bat"
    ],
    "suffix_ban_duration": 10
  }
}
```

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–ø–∞—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:**
```
.php, .asp, .aspx, .jsp, .cgi, .pl, .py, .rb, .lua
```

**–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:**
```
.exe, .bat, .cmd, .sh, .ps1, .vbs, .jar
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
```
.conf, .config, .ini, .cfg, .properties, .xml
```

**–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
```
.sql, .db, .sqlite, .mdb, .accdb
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–Ω–∞

| –£—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------------------|--------------|----------|
| –ù–∏–∑–∫–∏–π | 1-2 —á–∞—Å–∞ | –î–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π |
| –°—Ä–µ–¥–Ω–∏–π | 6-12 —á–∞—Å–æ–≤ | –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Å–∞–π—Ç–æ–≤ |
| –í—ã—Å–æ–∫–∏–π | 24-48 —á–∞—Å–æ–≤ | –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π | 168 —á–∞—Å–æ–≤ (–Ω–µ–¥–µ–ª—è) | –î–ª—è –≤—ã—Å–æ–∫–æ–∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º |

## üåç Geo-blocking

### –û–ø–∏—Å–∞–Ω–∏–µ

–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ IP –∞–¥—Ä–µ—Å–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏).

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "security": {
    "enable_geo_blocking": true,
    "blocked_countries": ["CN", "RU", "KP", "IR", "SY"]
  }
}
```

### ISO –∫–æ–¥—ã —Å—Ç—Ä–∞–Ω

**–ß–∞—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ–º—ã–µ —Å—Ç—Ä–∞–Ω—ã:**
```
CN - –ö–∏—Ç–∞–π
RU - –†–æ—Å—Å–∏—è  
KP - –°–µ–≤–µ—Ä–Ω–∞—è –ö–æ—Ä–µ—è
IR - –ò—Ä–∞–Ω
SY - –°–∏—Ä–∏—è
VE - –í–µ–Ω–µ—Å—É—ç–ª–∞
CU - –ö—É–±–∞
```

**–ï–≤—Ä–æ–ø–µ–π—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω—ã:**
```
DE - –ì–µ—Ä–º–∞–Ω–∏—è
FR - –§—Ä–∞–Ω—Ü–∏—è
GB - –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è
IT - –ò—Ç–∞–ª–∏—è
ES - –ò—Å–ø–∞–Ω–∏—è
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

–î–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≥–µ–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å:

1. **MaxMind GeoIP2** - –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
2. **IP2Location** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å
3. **GeoJS** - –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π API —Å–µ—Ä–≤–∏—Å

## ‚è±Ô∏è Rate Limiting

### –û–ø–∏—Å–∞–Ω–∏–µ

–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP –∞–¥—Ä–µ—Å–∞ –≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```json
{
  "rate_limit_rps": 60
}
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

| –¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | RPS | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|----------------|-----|-------------|
| –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç | 30-60 | –ù–∏–∑–∫–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å |
| –ë–ª–æ–≥/CMS | 60-120 | –°—Ä–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| E-commerce | 120-200 | –í—ã—Å–æ–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π |
| API —Å–µ—Ä–≤–∏—Å | 200-500 | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã | 500+ | –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ |

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. **Sliding Window** - —Å–∫–æ–ª—å–∑—è—â–µ–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ
2. **Token Bucket** - –≤–µ–¥—Ä–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –ø–∏–∫–æ–≤
3. **Fixed Window** - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã

## üè† IP Management

### Whitelist (–ë–µ–ª—ã–π —Å–ø–∏—Å–æ–∫)

–í—Å–µ–≥–¥–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ö–æ–¥—è—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

```json
{
  "allowed_ips": {
    "127.0.0.1": true,
    "::1": true,
    "192.168.1.0/24": true,
    "10.0.0.0/8": true
  }
}
```

### Blacklist (–ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫)

–ü–æ—Å—Ç–æ—è–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞:

```json
{
  "banned_ips": {
    "192.168.1.100": true,
    "203.0.113.0/24": true,
    "2001:db8::/32": true
  }
}
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- **–û–¥–∏–Ω–æ—á–Ω—ã–π IP:** `192.168.1.1`
- **CIDR –ø–æ–¥—Å–µ—Ç—å:** `192.168.1.0/24`
- **IPv6:** `2001:db8::1`
- **IPv6 –ø–æ–¥—Å–µ—Ç—å:** `2001:db8::/32`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ú–µ—Ç—Ä–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

Firewall —Å–æ–±–∏—Ä–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

```json
{
  "security_metrics": {
    "total_blocked": 1250,
    "sql_injection_attempts": 45,
    "xss_attempts": 23,
    "ddos_attacks": 8,
    "scanner_attempts": 156,
    "bot_requests": 89,
    "directory_access_attempts": 34,
    "malicious_file_requests": 12
  }
}
```

### –ê–ª–µ—Ä—Ç—ã –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö:

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f firewall.log | grep "ATTACK"

# –ü–æ–¥—Å—á–µ—Ç –∞—Ç–∞–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
grep "$(date '+%Y-%m-%d %H')" firewall.log | grep "ATTACK" | wc -l

# –¢–æ–ø –∞—Ç–∞–∫—É—é—â–∏—Ö IP
grep "ATTACK" firewall.log | awk '{print $3}' | sort | uniq -c | sort -nr | head -10
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**Prometheus –º–µ—Ç—Ä–∏–∫–∏:**
```
firewall_requests_total{status="blocked"}
firewall_attacks_total{type="sql_injection"}
firewall_banned_ips_total
```

**Grafana –¥–∞—à–±–æ—Ä–¥:**
- –ì—Ä–∞—Ñ–∏–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢–æ–ø –∞—Ç–∞–∫—É—é—â–∏—Ö IP
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫
- –°—Ç–∞—Ç—É—Å –º–æ–¥—É–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üõ°Ô∏è –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥—É–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

```json
{
  "security": {
    "enable_sql_protection": true,
    "enable_xss_protection": true,
    "enable_ddos_protection": true,
    "enable_scanner_protection": true,
    "enable_bot_protection": true
  }
}
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ —Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–î–ª—è API —Å–µ—Ä–≤–∏—Å–æ–≤:**
- –û—Ç–∫–ª—é—á–∏—Ç–µ suffix protection
- –£–≤–µ–ª–∏—á—å—Ç–µ rate limit
- –í–∫–ª—é—á–∏—Ç–µ —Å—Ç—Ä–æ–≥—É—é bot protection

**–î–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤:**
- –í–∫–ª—é—á–∏—Ç–µ –≤—Å–µ –º–æ–¥—É–ª–∏ –∑–∞—â–∏—Ç—ã
- –£–º–µ–Ω—å—à–∏—Ç–µ rate limit
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é DDoS –∑–∞—â–∏—Ç—É

### 3. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª

```bash
# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤
# –î–æ–±–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ SQL –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
# –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–ø–∏—Å–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö User-Agent'–æ–≤
# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –Ω–æ–≤—ã—Ö —É–≥—Ä–æ–∑
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏–∑

```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
grep "$(date '+%Y-%m-%d')" firewall.log | grep "BLOCKED" > daily_blocks.log

# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
awk '/ATTACK/ {attacks[$4]++} END {for (type in attacks) print type, attacks[type]}' firewall.log
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã

```bash
# –¢–µ—Å—Ç SQL injection –∑–∞—â–∏—Ç—ã
curl "http://localhost:8080/search?q=1' UNION SELECT * FROM users--"

# –¢–µ—Å—Ç XSS –∑–∞—â–∏—Ç—ã  
curl "http://localhost:8080/comment" -d "text=<script>alert('xss')</script>"

# –¢–µ—Å—Ç DDoS –∑–∞—â–∏—Ç—ã
for i in {1..200}; do curl http://localhost:8080/ & done
```

### 6. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
cp firewall.json /backup/firewall-$(date +%Y%m%d).json

# –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Git
git add firewall.json
git commit -m "Security config update $(date)"
```

### 7. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–í–µ–¥–∏—Ç–µ –∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

```
2024-01-15: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ SQL –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
2024-01-14: –£–≤–µ–ª–∏—á–µ–Ω DDoS threshold –¥–æ 150
2024-01-13: –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã IP –∏–∑ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 203.0.113.0/24
```

### 8. –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã

- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±—É—á–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –Ω–æ–≤—ã–º —É–≥—Ä–æ–∑–∞–º
- –ü—Ä–æ–≤–æ–¥–∏—Ç–µ —É—á–µ–Ω–∏—è –ø–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—é –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üö® –†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

### –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∞—Ç–∞–∫–∏

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
   - –ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –∞—Ç–∞–∫—É—é—â–∏–π IP
   - –£–≤–µ–ª–∏—á—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –£–≤–µ–¥–æ–º–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

2. **–ê–Ω–∞–ª–∏–∑:**
   - –ò–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ –∞—Ç–∞–∫–∏
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∏–ø –∏ –º–∞—Å—à—Ç–∞–± —É–≥—Ä–æ–∑—ã
   - –û—Ü–µ–Ω–∏—Ç–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π —É—â–µ—Ä–±

3. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ:**
   - –û–±–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞—â–∏—Ç—ã
   - –ó–∞–∫—Ä–æ–π—Ç–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
   - –£—Å–∏–ª—å—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞—Ç–∞–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
ATTACKS=$(grep "$(date '+%Y-%m-%d %H')" firewall.log | grep "ATTACK" | wc -l)

if [ $ATTACKS -gt 50 ]; then
    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞—â–∏—Ç—É
    curl -X POST http://localhost:9090/admin \
         -d "action=update_security&ddos_threshold=50"
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    echo "High attack volume detected: $ATTACKS attacks" | \
         mail -s "Security Alert" admin@example.com
fi
```

---

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –∑–∞—â–∏—Ç—É –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–æ–≤—ã–º–∏ —É–≥—Ä–æ–∑–∞–º–∏!

